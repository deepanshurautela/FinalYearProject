{% extends "base.html" %}
	{%block title%}{{twitter_handle}}{%endblock%}

{% block content %}
	{% for i in tweets %}
		<div class="card">
			<div class="card-body">
				 <h4 class="card-text">{{ i.text }}</h4>
 				<a href="#" class="btn btn-sm btn-outline-primary" id="{{i.id}}">Analyse</a>
 				<a href="{{ i.source_url }}" target="_blank" class="btn btn-sm btn-outline-primary">See on Twitter</a>
			</div>
		<canvas id="{{i.id}}c"></canvas>
		</div>
		<script type="text/javascript">
			var j = jQuery.noConflict();
			j("#{{i.id}}").click(function(e) {
    		e.preventDefault();
    		j.ajax({
		        type: "GET",
		        url: "/ajax/",
		        data: { 
		            text: "{{i.text}}"
		        },
		        success: function(result) {
						var ctx = document.getElementById('{{i.id}}c').getContext('2d');
						var chart = new Chart(ctx, {
					    // The type of chart we want to create
					    type: 'pie',

					    // The data for our dataset
					    data: {
					        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
					        datasets: [{
					            label: 'My First dataset',
					            backgroundColor: 'rgb(255, 99, 132)',
					            borderColor: 'rgb(255, 99, 132)',
					            data: [0, 10, 5, 2, 20, 30, 45]
					        }]
					    },

					    // Configuration options go here
					    options: {}
					});
						//alert(result);
		        },
		        error: function(result) {
		            alert('error');
		          }
    		});
		});
		</script>
	{% endfor %}
{% endblock %}


